# nsd1909-py01-day03

## 文件

文件操作的三个步骤：

- 打开
- 读写
- 关闭

### 读取文本文件

#### 字符编码

在计算机上存储字符时，都是以2进制0/1的方式存储。将一连串的01组合表示为一个字符。

美国采用的字符编码是ASCII码；西欧使用ISO－8859－1；中国采用GBK/GB2312/GB18030。

不同国家采用的编码方案不同，导致相同的01组合在不同国家代表不同的字符。为了解决这个问题，使得某种01的组合只能代表一个字符，ISO提示了万国码Unicode，常用的Unicode解决方案是utf8。

utf8是变长的，一个英文字符，占8位，一个汉字占24位。

python中，字符有str类型和bytes类型。str就是各种字符，如英文或中文。bytes是字节。一个英文字符正好是一个字节，一个汉字是三个字节

```python
>>> s1 = 'a'
>>> s2 = '中'
>>> type(s1)
<class 'str'>
>>> type(s2)
<class 'str'>
>>> s1.encode()  # 将str转为bytes类型
b'a'             # b表示bytes类型，一个英文字符正好是一个字节，就用字符本身表示
>>> s2.encode()  # 一个汉字是3个字节，转换成16进制数表示，\x表示16进制
b'\xe4\xb8\xad'
>>> bin(0xe4b8ad)  # 将16进制转成2进制，在磁盘上存'中'，就是存这些2进制数
'0b111001001011100010101101'
>>> b2 = s2.encode()
>>> b2
b'\xe4\xb8\xad'
>>> b2.decode()  # 将bytes类型转成str类型
'中'
```

```python
[root@localhost day03]# cp /etc/passwd /tmp/
>>> f = open('/tmp/password')  # 默认以r方式打开，文件不存在，报错
>>> f = open('/tmp/passwd')
>>> data = f.read()   # read默认读取全部内容，返回字符串
>>> f.close()
>>> print(data)

>>> f = open('/tmp/passwd')
>>> data = f.read()   # 读取文件内容，赋值给data
>>> data = f.read()   # 继续读取文件内容，赋值给data
>>> f.close()
>>> data
''

>>> f = open('/tmp/passwd')
>>> f.readline()  # 读1行
'root:x:0:0:root:/root:/bin/bash\n'
>>> f.readline()  # 继续读1行
'bin:x:1:1:bin:/bin:/sbin/nologin\n'
>>> f.readlines()  # 将剩余行全部读取出来，成为字符串列表
>>> f.readline()  # 因为已全部读取完，所以再读取，已经没有数据了
''
>>> f.close()


# **********重要：最常用的读取文本文件的方法**************
>>> f = open('/tmp/passwd')
>>> for line in f:
...     print(line, end='')
>>> f.close()
```

### 读取非文本文件

```python
>>> f = open('/tmp/aaa.jpg', 'rb')  # 需要以bytes方式打开
>>> f.read(10)    # 10表示，读取10字节
b'\xff\xd8\xff\xe0\x00\x10JFIF'
>>> f.close()
```

### 写入文本文件

```python
>>> f = open('/tmp/passwd', 'w')   # 文件不存在则创建，存在则清空
>>> f.write('Hello World.\n')   # 系统将会把数据写入缓存
13   # 表示写入了13字节
[root@localhost day03]# cat /tmp/passwd    # 文件为空
# 立即同步缓存数据到磁盘。不是必须的，当数据量达到4K时，也会写入磁盘；关闭文件时也会写入磁盘
>>> f.flush()
[root@localhost day03]# cat /tmp/passwd 
Hello World.
>>> f.writelines(['2nd line.\n', '3rd line.\n'])
>>> f.close()
[root@localhost day03]# cat /tmp/passwd 
Hello World.
2nd line.
3rd line.

```















